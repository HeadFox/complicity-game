<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>Le Jeu De La Complicit√©</title>
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            min-height: calc(100vh - 40px);
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2em;
        }

        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9em;
        }

        .logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
            display: block;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1.1em;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0) scale(0.98);
        }

        button.secondary {
            background: #6c757d;
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.4);
        }

        button.success {
            background: #28a745;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
        }

        button.danger {
            background: #dc3545;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
        }

        .other-team-section {
            margin: 20px 0;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 10px;
            border: 2px solid #17a2b8;
        }

        .other-team-section h4 {
            color: #17a2b8;
            margin-bottom: 10px;
            font-size: 1em;
        }

        button.info {
            background: #17a2b8;
            box-shadow: 0 4px 15px rgba(23, 162, 184, 0.4);
        }

        .team-themes {
            font-size: 0.85em;
            margin-top: 5px;
            opacity: 0.8;
        }
        button.warning {
            background: #ffc107;
            color: #333;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        .team-list {
            margin: 20px 0;
        }

        .team-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #e0e0e0;
        }

        .team-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .team-name {
            font-weight: 600;
            font-size: 1.1em;
        }

        .team-score {
            font-size: 1.3em;
            font-weight: bold;
        }

        .theme-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .theme-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            text-align: center;
        }

        .theme-item.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .theme-emoji {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .theme-name {
            font-weight: 600;
            font-size: 1em;
        }

        .theme-count {
            font-size: 0.8em;
            opacity: 0.7;
            margin-top: 5px;
        }

        .word-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            border-radius: 15px;
            text-align: center;
            font-size: 2.5em;
            font-weight: bold;
            margin: 30px 0;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .word-choices {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .word-choice-item {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid #e0e0e0;
            transition: all 0.3s;
            text-align: center;
            font-size: 1.5em;
            font-weight: 600;
        }

        .word-choice-item:active {
            transform: translateY(-3px) scale(0.98);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-color: #667eea;
        }

        .game-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .game-controls button {
            margin: 0;
        }

        .score-board {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: #667eea;
        }

        .intercept-team-list {
            margin: 20px 0;
        }

        .intercept-team-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
        }

        .intercept-team-item:active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .info-text {
            color: #666;
            font-size: 0.9em;
            margin: 10px 0;
            text-align: center;
        }

        .prep-info {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            color: #856404;
        }

        .winner-celebration {
            text-align: center;
            margin: 30px 0;
        }

        .winner-trophy {
            font-size: 5em;
            margin: 20px 0;
        }

        .winner-name {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        .history-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        .history-date {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .history-teams {
            font-weight: 600;
            margin: 5px 0;
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.5em;
            }

            .word-display {
                font-size: 2em;
                padding: 30px 15px;
            }

            .word-choice-item {
                font-size: 1.2em;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- √âcran d'accueil -->
        <div id="homeScreen" class="screen active">
            <svg class="logo" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <circle cx="100" cy="100" r="90" fill="url(#grad)" opacity="0.2"/>
                <circle cx="70" cy="80" r="25" fill="url(#grad)"/>
                <circle cx="130" cy="80" r="25" fill="url(#grad)"/>
                <path d="M 60 120 Q 100 150 140 120" stroke="url(#grad)" stroke-width="8" fill="none" stroke-linecap="round"/>
            </svg>
            <h1>Le Jeu De La Complicit√©</h1>
            <p class="subtitle">Devinettes par √©quipes</p>
            
            <button id="btnNewGame">Nouvelle Partie</button>
            <button id="btnContinue" class="success" style="display:none;">Continuer la partie</button>
            <button id="btnHistory" class="secondary">Historique</button>
            
            <div class="info-text" style="margin-top: 30px;">
                <p>üéØ Mode libre sans chronom√®tre</p>
                <p>‚úÖ +1 point si trouv√©</p>
                <p>‚è≠Ô∏è -0.5 point si pass√©</p>
                <p>üé™ Interception possible</p>
                <p>üé® Th√®mes par √©quipe</p>
            </div>
        </div>

        <!-- Configuration des √©quipes -->
        <div id="teamSetupScreen" class="screen">
            <h2>Configuration des √©quipes</h2>
            
            <input type="text" id="teamNameInput" placeholder="Nom de l'√©quipe" maxlength="30">
            <button id="btnAddTeam">Ajouter l'√©quipe</button>

            <div class="team-list" id="teamList"></div>

            <button id="btnStartThemeSelect" class="success" style="display:none;">
                Continuer
            </button>
        </div>

        <!-- S√©lection des th√®mes PAR √âQUIPE -->
        <div id="teamThemeSelectScreen" class="screen">
            <h2>S√©lection des th√®mes</h2>
            <div class="prep-info">
                <h3 style="margin-bottom: 10px;">√âquipe :</h3>
                <div id="themeSelectTeamName" style="font-size: 1.3em; font-weight: bold; color: #667eea;"></div>
            </div>
            <p class="info-text">Choisissez au moins un th√®me pour cette √©quipe</p>

            <div class="theme-grid" id="teamThemeGrid"></div>

            <button id="btnNextTeamTheme" class="success" style="display:none;">
                Continuer
            </button>
        </div>

        <!-- √âcran de pr√©paration -->
        <div id="prepScreen" class="screen">
            <h2>Pr√©parez-vous !</h2>
            
            <div class="prep-info">
                <h3 style="margin-bottom: 10px;">Au tour de :</h3>
                <div id="currentTeamName" style="font-size: 1.5em; font-weight: bold; color: #667eea;"></div>
            </div>

            <div class="info-text" style="margin: 30px 0;">
                <p style="margin-bottom: 15px;">üì± Passez le t√©l√©phone √† cette √©quipe</p>
                <p style="margin-bottom: 15px;">üëÄ Les autres ne regardent pas !</p>
                <p>üéØ Vous allez choisir parmi 3 mots</p>
            </div>

            <button id="btnReady" class="success">C'est parti ! üéÆ</button>
        </div>

        <!-- Choix de mots -->
        <div id="wordChoiceScreen" class="screen">
            <h2>Choisissez votre mot</h2>
            <p class="info-text">S√©lectionnez le mot que vous voulez faire deviner</p>

            <div class="word-choices" id="wordChoices"></div>
        </div>

        <!-- √âcran de jeu -->
        <div id="gameScreen" class="screen">
            <div class="score-board">
                <h3>Scores actuels</h3>
                <div id="scoreBoard"></div>
            </div>

            <div class="word-display" id="wordDisplay"></div>

            <!-- Section pour une autre √©quipe qui trouve -->
            <div class="other-team-section">
                <h4>üé™ Une autre √©quipe a trouv√© ?</h4>
                <select id="otherTeamSelect">
                    <option value="">-- S√©lectionner une √©quipe --</option>
                </select>
                <button id="btnOtherTeamFound" class="info" style="margin-top: 10px;">
                    ‚úÖ Cette √©quipe a trouv√©
                </button>
            </div>

            <div class="game-controls">
                <button id="btnCorrect" class="success">‚úÖ Mon √©quipe a trouv√©</button>
                <button id="btnPass" class="warning">‚è≠Ô∏è Passer</button>
            </div>

            <button id="btnPause" class="secondary">‚è∏Ô∏è Pause</button>
        </div>

        <!-- √âcran des scores -->
        <div id="scoreScreen" class="screen">
            <h2>Scores actuels</h2>

            <div class="team-list" id="scoreList"></div>

            <button id="btnContinueGame" class="success">Continuer la partie</button>
            <button id="btnEndGame" class="danger">Terminer la partie</button>
        </div>

        <!-- √âcran du gagnant -->
        <div id="winnerScreen" class="screen">
            <div class="winner-celebration">
                <div class="winner-trophy">üèÜ</div>
                <h1>Victoire !</h1>
                <div class="winner-name" id="winnerName"></div>
                <p id="winnerScore" style="font-size: 1.5em; margin: 10px 0;"></p>
            </div>

            <h3 style="text-align: center; margin: 20px 0;">Classement final</h3>
            <div class="team-list" id="finalScoreList"></div>

            <button id="btnNewGameFromWinner">Nouvelle partie</button>
            <button id="btnHomeFromWinner" class="secondary">Accueil</button>
        </div>

        <!-- √âcran d'historique -->
        <div id="historyScreen" class="screen">
            <h2>Historique des parties</h2>

            <div id="historyList"></div>

            <button id="btnBackFromHistory" class="secondary">Retour</button>
        </div>
    </div>

    <!-- Modal d'interception -->
    <div id="interceptModal" class="modal">
        <div class="modal-content">
            <h2>Interception ! üé™</h2>
            <p class="info-text">Une autre √©quipe veut-elle tenter de deviner ce mot ?</p>
            
            <div class="intercept-team-list" id="interceptTeamList"></div>

            <button id="btnNoIntercept" class="secondary">Pas d'interception</button>
        </div>
    </div>

    <script>
        // ============================================
        // DONN√âES DES MOTS
        // ============================================
        const WORDS_DATA = {
            cinema: {
                emoji: "üé¨",
                name: "Cin√©ma & S√©ries",
                words: ["Titanic", "Avatar", "Harry Potter", "Star Wars", "Le Seigneur des Anneaux", "Matrix", "Inception", "Jurassic Park", "Pirates des Cara√Øbes", "Batman", "Spider-Man", "Iron Man", "Avengers", "Game of Thrones", "Breaking Bad", "Friends", "Stranger Things", "The Walking Dead", "Prison Break", "Lost", "Gladiateur", "Forrest Gump", "Pulp Fiction", "Shrek", "Le Roi Lion", "La Reine des Neiges", "Toy Story", "Indiana Jones", "Rocky", "James Bond", "Terminator", "Retour vers le futur", "Star Trek", "Alien", "Predator", "Rambo", "Die Hard", "Mission Impossible", "Fast and Furious", "Transformers", "X-Men", "Deadpool", "Wonder Woman", "Superman", "Captain America", "Thor", "Hulk", "Black Panther", "Doctor Strange", "Guardians of the Galaxy", "Ant-Man", "Aquaman", "Flash", "Arrow", "Narcos", "The Crown", "Black Mirror", "Vikings", "Peaky Blinders", "Sherlock", "Westworld", "The Witcher", "The Mandalorian", "House of Cards", "Dexter", "True Detective", "Fargo", "Better Call Saul", "The Office", "How I Met Your Mother", "Big Bang Theory", "Brooklyn Nine-Nine", "Parks and Recreation", "Modern Family", "The Simpsons", "South Park", "Family Guy", "Rick and Morty", "BoJack Horseman", "Squid Game", "Money Heist", "Dark", "Lupin", "The Umbrella Academy", "Cobra Kai", "Bridgerton", "Emily in Paris", "The Queen's Gambit"]
            },
            celebrites: {
                emoji: "‚≠ê",
                name: "C√©l√©brit√©s",
                words: ["Beyonc√©", "Rihanna", "Taylor Swift", "Lady Gaga", "Madonna", "Michael Jackson", "Elvis Presley", "The Beatles", "Queen", "David Bowie", "Prince", "Bob Marley", "Freddie Mercury", "Johnny Depp", "Leonardo DiCaprio", "Brad Pitt", "Angelina Jolie", "Tom Cruise", "Will Smith", "Dwayne Johnson", "Robert Downey Jr", "Scarlett Johansson", "Jennifer Lawrence", "Meryl Streep", "Denzel Washington", "Morgan Freeman", "Samuel L Jackson", "Harrison Ford", "Matt Damon", "George Clooney", "Julia Roberts", "Sandra Bullock", "Tom Hanks", "Nicole Kidman", "Charlize Theron", "Cristiano Ronaldo", "Lionel Messi", "Neymar", "Kylian Mbapp√©", "LeBron James", "Michael Jordan", "Serena Williams", "Roger Federer", "Rafael Nadal", "Usain Bolt", "Mike Tyson", "Muhammad Ali", "Floyd Mayweather", "Conor McGregor", "Lewis Hamilton", "Barack Obama", "Donald Trump", "Joe Biden", "Emmanuel Macron", "Angela Merkel", "Vladimir Putin", "Xi Jinping", "Oprah Winfrey", "Ellen DeGeneres", "Jimmy Fallon", "Elon Musk", "Bill Gates", "Mark Zuckerberg", "Jeff Bezos", "Steve Jobs", "Warren Buffett", "Kim Kardashian", "Kanye West", "Justin Bieber", "Ariana Grande"]
            },
            lieux: {
                emoji: "üåç",
                name: "Lieux",
                words: ["Paris", "Londres", "New York", "Tokyo", "Rome", "Barcelone", "Dubai", "Sydney", "Rio de Janeiro", "Le Caire", "Moscou", "P√©kin", "Los Angeles", "Las Vegas", "Miami", "San Francisco", "Chicago", "Toronto", "Vancouver", "Mexico", "Buenos Aires", "Lima", "Amsterdam", "Berlin", "Munich", "Vienne", "Prague", "Budapest", "Ath√®nes", "Istanbul", "J√©rusalem", "Tel Aviv", "Mumbai", "Bangkok", "Singapour", "Hong Kong", "S√©oul", "Shanghai", "Melbourne", "Auckland", "Cap Town", "Marrakech", "Casablanca", "Tunis", "Alger", "Dakar", "Nairobi", "Lagos", "La Tour Eiffel", "Big Ben", "Statue de la Libert√©", "Colis√©e", "Taj Mahal", "Grande Muraille", "Christ R√©dempteur", "Machu Picchu", "Petra", "Pyramides", "Stonehenge", "Acropole", "Sagrada Familia", "Mont Saint-Michel", "Versailles"]
            },
            animaux: {
                emoji: "ü¶Å",
                name: "Animaux",
                words: ["Lion", "Tigre", "√âl√©phant", "Girafe", "Z√®bre", "Rhinoc√©ros", "Hippopotame", "Crocodile", "Gorille", "Chimpanz√©", "Orang-outan", "Panda", "Koala", "Kangourou", "Ours", "Loup", "Renard", "Cerf", "Sanglier", "Aigle", "Faucon", "Hibou", "Perroquet", "Flamant rose", "Pingouin", "Manchot", "Dauphin", "Baleine", "Requin", "Pieuvre", "M√©duse", "Tortue", "Serpent", "Cobra", "Python", "Boa", "Iguane", "Cam√©l√©on", "Grenouille", "Crapaud", "Salamandre", "Papillon", "Abeille", "Gu√™pe", "Fourmi", "Coccinelle", "Libellule", "Sauterelle", "Araign√©e", "Scorpion", "Crabe", "Homard", "Crevette", "Mouette", "Albatros", "Colibri", "Toucan", "Autruche", "Paon", "Cygne", "Canard", "Oie", "Poule", "Coq", "Dindon", "Cheval", "√Çne", "Chameau", "Dromadaire", "Lama", "Alpaga", "Bison", "Buffle", "Vache", "Mouton", "Ch√®vre", "Cochon", "Lapin", "√âcureuil", "Castor", "Rat", "Souris", "H√©risson"]
            },
            nourriture: {
                emoji: "üçï",
                name: "Nourriture",
                words: ["Pizza", "Burger", "Hot-dog", "Tacos", "Sushi", "Ramen", "Pasta", "Lasagne", "Paella", "Couscous", "Tajine", "Curry", "Pad Thai", "Pho", "Dim Sum", "Fajitas", "Burrito", "Quesadilla", "Nachos", "Guacamole", "Hummus", "Falafel", "Kebab", "Shawarma", "Fish and Chips", "Fondue", "Raclette", "Tartiflette", "Cassoulet", "Pot-au-feu", "Blanquette", "Boeuf bourguignon", "Ratatouille", "Quiche", "Cr√™pe", "Croissant", "Pain au chocolat", "Macaron", "√âclair", "Tarte Tatin", "Cr√®me br√ªl√©e", "Profiterole", "Tiramisu", "Panna cotta", "Cannoli", "Baklava", "Churros", "Flan", "Brownie", "Cheesecake", "Carrot cake", "Red velvet", "Cupcake", "Donut", "Muffin", "Cookie", "Pancake", "Waffle", "Toast", "Bagel", "Pretzel", "Popcorn", "Chips", "Frites", "Onion rings", "Nuggets", "Wings", "Ribs", "Steak", "Bacon", "Saucisse", "Merguez", "Chorizo"]
            },
            objets: {
                emoji: "üîß",
                name: "Objets",
                words: ["T√©l√©phone", "Ordinateur", "Tablette", "Montre", "Lunettes", "Cl√©s", "Portefeuille", "Sac", "Valise", "Parapluie", "Chapeau", "Casquette", "√âcharpe", "Gants", "Ceinture", "Cravate", "Chaussures", "Baskets", "Bottes", "Sandales", "Chaussettes", "Stylo", "Crayon", "Gomme", "Taille-crayon", "R√®gle", "Compas", "Calculatrice", "Livre", "Cahier", "Journal", "Magazine", "Carte", "Poster", "Photo", "Cadre", "Miroir", "Horloge", "R√©veil", "Lampe", "Bougie", "Briquet", "Allumettes", "Ciseaux", "Colle", "Scotch", "Agrafeuse", "Perforeuse", "Trombones", "√âlastiques", "Punaises", "Marteau", "Tournevis", "Clou", "Vis", "Pince", "Scie", "Perceuse", "√âchelle", "Escabeau", "Balai", "Serpilli√®re", "Aspirateur", "Fer √† repasser", "Planche √† repasser", "Machine √† laver", "S√®che-linge", "Lave-vaisselle", "Four", "Micro-ondes", "Frigo", "Cong√©lateur", "Cafeti√®re", "Bouilloire", "Grille-pain", "Mixeur", "Blender", "Robot", "Casserole", "Po√™le", "Marmite", "Cocotte"]
            },
            sports: {
                emoji: "‚öΩ",
                name: "Sports",
                words: ["Football", "Basketball", "Tennis", "Rugby", "Volleyball", "Handball", "Golf", "Baseball", "Cricket", "Hockey", "Boxe", "Karat√©", "Judo", "Taekwondo", "Kung-fu", "Capoeira", "Lutte", "MMA", "Natation", "Plongeon", "Water-polo", "Surf", "Ski", "Snowboard", "Patinage", "Bobsleigh", "Luge", "Curling", "Cyclisme", "VTT", "BMX", "Athl√©tisme", "Sprint", "Marathon", "Saut en hauteur", "Saut en longueur", "Triple saut", "Perche", "Javelot", "Disque", "Marteau", "Poids", "D√©cathlon", "Heptathlon", "Gymnastique", "Trampoline", "Escalade", "Alpinisme", "Parachutisme", "Parapente", "Deltaplane", "Kitesurf", "Planche √† voile", "Voile", "Aviron", "Cano√´", "Kayak", "Rafting", "Plong√©e", "Apn√©e", "Escrime", "Tir √† l'arc", "√âquitation", "Polo", "P√©tanque", "Bowling", "Billard", "Fl√©chettes", "Ping-pong", "Badminton", "Squash"]
            },
            art: {
                emoji: "üé®",
                name: "Art & Culture",
                words: ["Peinture", "Sculpture", "Dessin", "Photographie", "Architecture", "Musique", "Danse", "Th√©√¢tre", "Cin√©ma", "Litt√©rature", "Po√©sie", "Roman", "Nouvelle", "Essai", "BD", "Manga", "Comics", "Op√©ra", "Ballet", "Jazz", "Rock", "Pop", "Rap", "Hip-hop", "Reggae", "Blues", "Country", "Folk", "Classique", "√âlectro", "Techno", "House", "Dubstep", "Metal", "Punk", "Grunge", "Soul", "Funk", "Disco", "Salsa", "Tango", "Flamenco", "Valse", "Samba", "Rumba", "Cha-cha", "Bachata", "Merengue", "Zouk", "Mona Lisa", "La Joconde", "Guernica", "Le Cri", "La Nuit √©toil√©e", "Les Tournesols", "La Cr√©ation d'Adam", "David", "Venus de Milo", "Le Penseur", "Louvre", "Versailles", "Orsay", "Prado"]
            },
            metiers: {
                emoji: "üë®‚Äçüíº",
                name: "M√©tiers",
                words: ["M√©decin", "Infirmier", "Chirurgien", "Dentiste", "Pharmacien", "V√©t√©rinaire", "Avocat", "Juge", "Notaire", "Policier", "Gendarme", "Pompier", "Militaire", "Professeur", "Instituteur", "Directeur", "Ing√©nieur", "Architecte", "Designer", "Graphiste", "Photographe", "Vid√©aste", "Journaliste", "Reporter", "Pr√©sentateur", "Acteur", "Chanteur", "Musicien", "Danseur", "Artiste", "Peintre", "Sculpteur", "√âcrivain", "Po√®te", "Romancier", "Chef cuisinier", "P√¢tissier", "Boulanger", "Boucher", "Poissonnier", "Fleuriste", "Coiffeur", "Esth√©ticien", "M√©canicien", "√âlectricien", "Plombier", "Ma√ßon", "Menuisier", "Peintre en b√¢timent", "Jardinier", "Agriculteur", "√âleveur", "P√™cheur", "Marin", "Pilote", "H√¥tesse de l'air", "Chauffeur", "Livreur", "Facteur", "Banquier", "Comptable", "Assureur", "Agent immobilier", "Commercial", "Vendeur", "Caissier", "Serveur", "Barman"]
            },
            nature: {
                emoji: "üå≥",
                name: "Nature",
                words: ["Arbre", "Fleur", "Rose", "Tulipe", "Orchid√©e", "Tournesol", "Marguerite", "Lavande", "Jasmin", "Lilas", "Pivoine", "Iris", "Dahlia", "Hortensia", "Azal√©e", "Rhododendron", "Coquelicot", "Bleuet", "Pissenlit", "Muguet", "Violette", "Primev√®re", "P√¢querette", "For√™t", "Jungle", "Savane", "D√©sert", "Montagne", "Colline", "Vall√©e", "Plaine", "Prairie", "Champ", "Pr√©", "Mer", "Oc√©an", "Lac", "Rivi√®re", "Fleuve", "Ruisseau", "Cascade", "Chute d'eau", "Volcan", "Glacier", "Iceberg", "√éle", "P√©ninsule", "Cap", "Baie", "Golf", "D√©troit", "Falaise", "Grotte", "Caverne", "Canyon", "Gorge", "Ravin", "Dune", "Oasis", "Atoll", "R√©cif", "Lagon", "Marais", "Tourbi√®re", "Mangrove", "Banquise", "Toundra", "Ta√Øga", "Steppe", "Pampa", "Brousse", "Maquis", "Garrigue", "Lande", "Bocage", "Verger", "Vignoble", "Potager", "Jardin", "Parc", "R√©serve"]
            },
            marques: {
                emoji: "üè¢",
                name: "Marques",
                words: ["Apple", "Samsung", "Google", "Microsoft", "Amazon", "Facebook", "Instagram", "Twitter", "TikTok", "Snapchat", "WhatsApp", "YouTube", "Netflix", "Spotify", "Disney", "Nike", "Adidas", "Puma", "Reebok", "Under Armour", "Coca-Cola", "Pepsi", "McDonald's", "KFC", "Burger King", "Starbucks", "Subway", "Pizza Hut", "Domino's", "Toyota", "Mercedes", "BMW", "Audi", "Volkswagen", "Ford", "Ferrari", "Lamborghini", "Porsche", "Tesla", "Renault", "Peugeot", "Citro√´n", "Chanel", "Dior", "Gucci", "Prada", "Louis Vuitton", "Herm√®s", "Rolex", "Cartier", "Tiffany", "Zara", "H&M", "Uniqlo", "Gap", "Levi's", "Lacoste", "Ralph Lauren", "Tommy Hilfiger", "Calvin Klein", "Sony", "LG", "Panasonic", "Canon", "Nikon", "GoPro", "PlayStation", "Xbox", "Nintendo", "IKEA", "LEGO", "Barbie", "Hot Wheels", "Nerf", "Hasbro", "Mattel", "L'Or√©al", "Nivea", "Dove"]
            },
            emotions: {
                emoji: "üòä",
                name: "√âmotions",
                words: ["Joie", "Bonheur", "Euphorie", "Extase", "Ravissement", "All√©gresse", "Gaiet√©", "Enthousiasme", "Excitation", "Exaltation", "Tristesse", "Chagrin", "Peine", "M√©lancolie", "Nostalgie", "Cafard", "Spleen", "D√©sespoir", "D√©tresse", "Affliction", "Col√®re", "Rage", "Fureur", "Irritation", "Agacement", "Exasp√©ration", "Ressentiment", "Amertume", "Rancune", "Haine", "Peur", "Crainte", "Terreur", "Effroi", "√âpouvante", "Angoisse", "Anxi√©t√©", "Inqui√©tude", "Appr√©hension", "Trac", "Amour", "Tendresse", "Affection", "Attachement", "Passion", "D√©sir", "Envie", "Convoitise", "Jalousie", "Surprise", "√âtonnement", "Stup√©faction", "√âbahissement", "√âmerveillement", "Admiration", "Respect", "V√©n√©ration", "D√©go√ªt", "R√©pulsion", "Aversion", "√âc≈ìurement", "Honte", "G√™ne", "Embarras", "Culpabilit√©", "Remords", "Regret"]
            },
            technologie: {
                emoji: "üì±",
                name: "Technologie",
                words: ["Smartphone", "Ordinateur", "Laptop", "Tablette", "Montre connect√©e", "√âcouteurs", "Casque", "Enceinte", "Webcam", "Micro", "Clavier", "Souris", "√âcran", "Imprimante", "Scanner", "Routeur", "Modem", "WiFi", "Bluetooth", "USB", "Disque dur", "SSD", "RAM", "Processeur", "Carte graphique", "Batterie", "Chargeur", "C√¢ble", "Adaptateur", "Hub", "Internet", "Web", "Site", "Application", "Logiciel", "Programme", "Code", "Algorithme", "Base de donn√©es", "Serveur", "Cloud", "API", "HTML", "CSS", "JavaScript", "Python", "Java", "C++", "Ruby", "PHP", "SQL", "Intelligence artificielle", "Machine learning", "Deep learning", "Big data", "Blockchain", "Crypto", "Bitcoin", "NFT", "R√©alit√© virtuelle", "VR", "R√©alit√© augment√©e"]
            }
        };

        // ============================================
        // √âTAT DU JEU
        // ============================================
        let gameState = {
            screen: 'home',
            teams: [],
            selectedThemes: [],
            currentTeamIndex: 0,
            currentWord: '',
            wordChoices: [],
            usedWords: [],
            scoreHistory: []
        };

        // ============================================
        // FONCTIONS UTILITAIRES
        // ============================================
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            gameState.screen = screenId;
        }

        function saveGame() {
            localStorage.setItem('savedGame', JSON.stringify(gameState));
        }

        function loadGame() {
            const saved = localStorage.getItem('savedGame');
            if (saved) {
                gameState = JSON.parse(saved);
                return true;
            }
            return false;
        }

        function loadUsedWords() {
            const saved = localStorage.getItem('usedWords');
            if (saved) {
                gameState.usedWords = JSON.parse(saved);
            }
        }

        function saveUsedWords() {
            localStorage.setItem('usedWords', JSON.stringify(gameState.usedWords));
        }

        function loadHistory() {
            const saved = localStorage.getItem('scoreHistory');
            if (saved) {
                gameState.scoreHistory = JSON.parse(saved);
            }
        }

        function saveHistory() {
            localStorage.setItem('scoreHistory', JSON.stringify(gameState.scoreHistory));
        }

        function getAvailableWords() {
            let allWords = [];
            gameState.selectedThemes.forEach(themeKey => {
                allWords = allWords.concat(WORDS_DATA[themeKey].words);
            });
            return allWords.filter(word => !gameState.usedWords.includes(word));
        }

        function getRandomWords(count = 3) {
            const available = getAvailableWords();
            if (available.length === 0) {
                gameState.usedWords = [];
                saveUsedWords();
                return getRandomWords(count);
            }
            
            const shuffled = available.sort(() => Math.random() - 0.5);
            return shuffled.slice(0, Math.min(count, available.length));
        }

        // ============================================
        // √âCRAN D'ACCUEIL
        // ============================================
        document.getElementById('btnNewGame').addEventListener('click', () => {
            localStorage.removeItem('savedGame');
            gameState = {
                screen: 'teamSetup',
                teams: [],
                selectedThemes: [],
                currentTeamIndex: 0,
                currentWord: '',
                wordChoices: [],
                usedWords: gameState.usedWords || [],
                scoreHistory: gameState.scoreHistory || []
            };
            showScreen('teamSetupScreen');
        });

        document.getElementById('btnContinue').addEventListener('click', () => {
            if (loadGame()) {
                showScreen(gameState.screen + 'Screen');
                if (gameState.screen === 'prep') {
                    document.getElementById('currentTeamName').textContent = gameState.teams[gameState.currentTeamIndex].name;
                } else if (gameState.screen === 'wordChoice') {
                    renderWordChoices();
                } else if (gameState.screen === 'game') {
                    renderGameScreen();
                }
            }
        });

        document.getElementById('btnHistory').addEventListener('click', () => {
            showScreen('historyScreen');
            renderHistory();
        });

        // ============================================
        // CONFIGURATION DES √âQUIPES
        // ============================================
        const teamNameInput = document.getElementById('teamNameInput');
        const teamList = document.getElementById('teamList');
        const btnStartThemeSelect = document.getElementById('btnStartThemeSelect');

        document.getElementById('btnAddTeam').addEventListener('click', addTeam);
        teamNameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addTeam();
        });

        function addTeam() {
            const name = teamNameInput.value.trim();
            if (name && gameState.teams.length < 10) {
                gameState.teams.push({ name, score: 0 });
                teamNameInput.value = '';
                renderTeamList();
            }
        }

        function removeTeam(index) {
            gameState.teams.splice(index, 1);
            renderTeamList();
        }

        function renderTeamList() {
            teamList.innerHTML = '';
            if (gameState.teams.length > 0) {
                const title = document.createElement('h3');
                title.textContent = `√âquipes (${gameState.teams.length})`;
                teamList.appendChild(title);

                gameState.teams.forEach((team, index) => {
                    const div = document.createElement('div');
                    div.className = 'team-item';
                    div.innerHTML = `
                        <span class="team-name">${team.name}</span>
                        <button class="danger" style="width:auto;padding:8px 15px;margin:0;" onclick="removeTeam(${index})">
                            Supprimer
                        </button>
                    `;
                    teamList.appendChild(div);
                });
            }
            
            btnStartThemeSelect.style.display = gameState.teams.length >= 2 ? 'block' : 'none';
            if (gameState.teams.length >= 2) {
                btnStartThemeSelect.textContent = `Continuer (${gameState.teams.length} √©quipes)`;
            }
        }

        // Rendre removeTeam globale pour onclick
        window.removeTeam = removeTeam;

        document.getElementById('btnStartThemeSelect').addEventListener('click', () => {
            showScreen('teamThemeSelectScreen');
            renderThemeGrid();
        });

        // ============================================
        // S√âLECTION DES TH√àMES
        // ============================================
        function renderThemeGrid() {
            const grid = document.getElementById('teamThemeGrid');
            grid.innerHTML = '';

            Object.entries(WORDS_DATA).forEach(([key, theme]) => {
                const div = document.createElement('div');
                div.className = 'theme-item';
                if (gameState.selectedThemes.includes(key)) {
                    div.classList.add('selected');
                }
                div.innerHTML = `
                    <div class="theme-emoji">${theme.emoji}</div>
                    <div class="theme-name">${theme.name}</div>
                    <div class="theme-count">${theme.words.length} mots</div>
                `;
                div.addEventListener('click', () => toggleTheme(key));
                grid.appendChild(div);
            });

            updateStartButton();
        }

        function toggleTheme(themeKey) {
            const index = gameState.selectedThemes.indexOf(themeKey);
            if (index > -1) {
                gameState.selectedThemes.splice(index, 1);
            } else {
                gameState.selectedThemes.push(themeKey);
            }
            renderThemeGrid();
        }

        function updateStartButton() {
            const btn = document.getElementById('btnNextTeamTheme');
            btn.style.display = gameState.selectedThemes.length > 0 ? 'block' : 'none';
            if (gameState.selectedThemes.length > 0) {
                btn.textContent = `Commencer (${gameState.selectedThemes.length} th√®mes)`;
            }
        }

        document.getElementById('btnNextTeamTheme').addEventListener('click', () => {
            gameState.currentTeamIndex = 0;
            showScreen('prepScreen');
            document.getElementById('currentTeamName').textContent = gameState.teams[0].name;
            saveGame();
        });

        // ============================================
        // PR√âPARATION
        // ============================================
        document.getElementById('btnReady').addEventListener('click', () => {
            gameState.wordChoices = getRandomWords(3);
            showScreen('wordChoiceScreen');
            renderWordChoices();
        });

        // ============================================
        // CHOIX DE MOTS
        // ============================================
        function renderWordChoices() {
            const container = document.getElementById('wordChoices');
            container.innerHTML = '';

            gameState.wordChoices.forEach(word => {
                const div = document.createElement('div');
                div.className = 'word-choice-item';
                div.textContent = word;
                div.addEventListener('click', () => selectWord(word));
                container.appendChild(div);
            });
        }

        function selectWord(word) {
            gameState.currentWord = word;
            gameState.usedWords.push(word);
            saveUsedWords();
            showScreen('gameScreen');
            renderGameScreen();
            saveGame();
        }

        // ============================================
        // √âCRAN DE JEU
        // ============================================
        function renderGameScreen() {
            // Afficher le mot
            document.getElementById('wordDisplay').textContent = gameState.currentWord;

            // Afficher les scores
            const scoreBoard = document.getElementById('scoreBoard');
            scoreBoard.innerHTML = '';
            
            gameState.teams.forEach((team, index) => {
                const div = document.createElement('div');
                div.className = 'team-item' + (index === gameState.currentTeamIndex ? ' active' : '');
                div.innerHTML = `
                    <span class="team-name">${team.name}</span>
                    <span class="team-score">${team.score} pts</span>
                `;
                scoreBoard.appendChild(div);
            });
        }

        document.getElementById('btnCorrect').addEventListener('click', () => {
            gameState.teams[gameState.currentTeamIndex].score += 1;
            nextTurn();
        });

        document.getElementById('btnPass').addEventListener('click', () => {
            if (gameState.teams.length >= 3) {
                showInterceptModal();
            } else {
                applyPassPenalty();
                nextTurn();
            }
        });

        document.getElementById('btnPause').addEventListener('click', () => {
            saveGame();
            showScreen('scoreScreen');
            renderScoreScreen();
        });

        function applyPassPenalty() {
            gameState.teams[gameState.currentTeamIndex].score -= 0.5;
        }

        function nextTurn() {
            gameState.currentTeamIndex = (gameState.currentTeamIndex + 1) % gameState.teams.length;
            showScreen('prepScreen');
            document.getElementById('currentTeamName').textContent = gameState.teams[gameState.currentTeamIndex].name;
            saveGame();
        }

        // ============================================
        // MODAL D'INTERCEPTION
        // ============================================
        function showInterceptModal() {
            const modal = document.getElementById('interceptModal');
            const list = document.getElementById('interceptTeamList');
            
            list.innerHTML = '';
            gameState.teams.forEach((team, index) => {
                if (index !== gameState.currentTeamIndex) {
                    const div = document.createElement('div');
                    div.className = 'intercept-team-item';
                    div.textContent = team.name;
                    div.addEventListener('click', () => handleIntercept(index));
                    list.appendChild(div);
                }
            });

            modal.classList.add('active');
        }

        function hideInterceptModal() {
            document.getElementById('interceptModal').classList.remove('active');
        }

        function handleIntercept(teamIndex) {
            applyPassPenalty();
            gameState.currentTeamIndex = teamIndex;
            hideInterceptModal();
            renderGameScreen();
        }

        document.getElementById('btnNoIntercept').addEventListener('click', () => {
            hideInterceptModal();
            applyPassPenalty();
            nextTurn();
        });

        // ============================================
        // √âCRAN DES SCORES
        // ============================================
        function renderScoreScreen() {
            const list = document.getElementById('scoreList');
            list.innerHTML = '';

            const sortedTeams = [...gameState.teams].sort((a, b) => b.score - a.score);
            sortedTeams.forEach((team, index) => {
                const div = document.createElement('div');
                div.className = 'team-item';
                const medal = index === 0 ? 'ü•á ' : index === 1 ? 'ü•à ' : index === 2 ? 'ü•â ' : '';
                div.innerHTML = `
                    <span class="team-name">${medal}${team.name}</span>
                    <span class="team-score">${team.score} pts</span>
                `;
                list.appendChild(div);
            });
        }

        document.getElementById('btnContinueGame').addEventListener('click', () => {
            showScreen('prepScreen');
            document.getElementById('currentTeamName').textContent = gameState.teams[gameState.currentTeamIndex].name;
        });

        document.getElementById('btnEndGame').addEventListener('click', () => {
            const winner = [...gameState.teams].sort((a, b) => b.score - a.score)[0];
            
            gameState.scoreHistory.unshift({
                date: new Date().toISOString(),
                winner,
                teams: gameState.teams,
                themes: gameState.selectedThemes
            });
            gameState.scoreHistory = gameState.scoreHistory.slice(0, 10);
            saveHistory();

            showScreen('winnerScreen');
            renderWinnerScreen(winner);
            localStorage.removeItem('savedGame');
        });

        // ============================================
        // √âCRAN DU GAGNANT
        // ============================================
        function renderWinnerScreen(winner) {
            document.getElementById('winnerName').textContent = winner.name;
            document.getElementById('winnerScore').textContent = `${winner.score} points`;

            const list = document.getElementById('finalScoreList');
            list.innerHTML = '';

            const sortedTeams = [...gameState.teams].sort((a, b) => b.score - a.score);
            sortedTeams.forEach((team, index) => {
                const div = document.createElement('div');
                div.className = 'team-item';
                const medal = index === 0 ? 'ü•á ' : index === 1 ? 'ü•à ' : index === 2 ? 'ü•â ' : '';
                div.innerHTML = `
                    <span class="team-name">${medal}${team.name}</span>
                    <span class="team-score">${team.score} pts</span>
                `;
                list.appendChild(div);
            });
        }

        document.getElementById('btnNewGameFromWinner').addEventListener('click', () => {
            document.getElementById('btnNewGame').click();
        });

        document.getElementById('btnHomeFromWinner').addEventListener('click', () => {
            showScreen('homeScreen');
        });

        // ============================================
        // HISTORIQUE
        // ============================================
        function renderHistory() {
            const list = document.getElementById('historyList');
            list.innerHTML = '';

            if (gameState.scoreHistory.length === 0) {
                list.innerHTML = '<p class="info-text">Aucune partie termin√©e</p>';
                return;
            }

            gameState.scoreHistory.forEach(game => {
                const div = document.createElement('div');
                div.className = 'history-item';
                
                const date = new Date(game.date);
                const dateStr = date.toLocaleDateString('fr-FR', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                div.innerHTML = `
                    <div class="history-date">${dateStr}</div>
                    <div class="history-teams">üèÜ Gagnant : ${game.winner.name} (${game.winner.score} pts)</div>
                    <div style="font-size:0.9em;color:#666;margin-top:5px;">
                        ${game.teams.length} √©quipes - ${game.themes.length} th√®mes
                    </div>
                `;
                list.appendChild(div);
            });
        }

        document.getElementById('btnBackFromHistory').addEventListener('click', () => {
            showScreen('homeScreen');
        });

        // ============================================
        // INITIALISATION
        // ============================================
        loadUsedWords();
        loadHistory();

        if (localStorage.getItem('savedGame')) {
            document.getElementById('btnContinue').style.display = 'block';
        }
    </script>
</body>
</html>